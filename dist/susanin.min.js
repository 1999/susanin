!function(t){function e(t){return{"./querystring":function(){var t={},e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=function(t){return"[object Array]"===r.call(t)},a={decode:function(t){var e;try{e=decodeURIComponent(t.replace(/\+/g,"%20"))}catch(r){e=t}return e},parse:function(t,r,i){var s,o,u,p,l,f,h={};if(arguments.length||(t=location.search.substr(1)),!t)return h;for(r||(r="&"),i||(i="="),s=t.split(r),l=0,f=s.length;f>l;++l)o=s[l].split(i),u="undefined"!=typeof o[1]?a.decode(o[1]):"",p=a.decode(o[0]),e.call(h,p)?n(h[p])?h[p].push(u):h[p]=[h[p],u]:h[p]=u;return h},stringify:function(t,r,n){var a,i,s,o,u,p,l="";if(!t)return l;r||(r="&"),n||(n="=");for(p in t)if(e.call(t,p))for(s=[].concat(t[p]),o=0,u=s.length;u>o;++o)i=typeof s[o],a="object"===i||"undefined"===i?"":encodeURIComponent(s[o]),l+=r+encodeURIComponent(p)+n+a;return l.substr(r.length)}};return t.exports=a,t.exports},"./route":function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e&&(e={pattern:e}),!e||"object"!=typeof e)throw new Error("You must specify options");if("string"!=typeof e.pattern)throw new Error("You must specify the pattern of the route");this._pattern=e.pattern,this._conditions=e.conditions&&"object"==typeof e.conditions?e.conditions:{},this._defaults=e.defaults&&"object"==typeof e.defaults?e.defaults:{},this._data=e.data&&"object"==typeof e.data?e.data:{},"string"==typeof e.name&&(this._data.name=e.name),"function"==typeof e.filterMatch&&(this._filterMatch=e.filterMatch),"function"==typeof e.filterBuild&&(this._filterBuild=e.filterBuild),this._pattern+=l+"?"+u+"query_string"+p+f,this._conditions.query_string=".*",this._parts=this._parsePattern(this._pattern),this._buildParseRegExp()._buildBuildFn()}var r={},n=Object.prototype.hasOwnProperty,a=Object.prototype.toString,i=function(t){return"[object Array]"===a.call(t)},s=e("./querystring"),o=function(){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],e=new RegExp("(\\"+t.join("|\\")+")","g");return function(t){return t.replace(e,"\\$1")}}(),u="<",p=">",l="(",f=")",h="[a-zA-Z_][\\w\\-]*",c="[\\w\\-]+",d=new RegExp("("+o(u)+h+o(p)+"|"+"[^"+o(u)+o(p)+"]+"+"|"+o(u)+"|"+o(p)+")","g");return t.prototype._parsePattern=function(t){for(var e,r,n,a=[],i="",s=0,o=0,u=!1,p=t.length;p>s;)if(e=t.charAt(s++),e===l)u?(++o,i+=e):(this._parseParams(i,a),i="",o=0,u=!0);else if(e===f)if(u)if(0===o){for(i={what:"optional",dependOnParams:[],parts:this._parsePattern(i)},a.push(i),r=0,n=i.parts.length;n>r;++r)i.parts[r]&&"param"===i.parts[r].what&&i.dependOnParams.push(i.parts[r].name);i="",u=!1}else--o,i+=e;else i+=e;else i+=e;return this._parseParams(i,a),a},t.prototype._parseParams=function(t,e){var r,n,a,i=t.match(d);if(i)for(r=0,n=i.length;n>r;++r)a=i[r],a.charAt(0)===u&&a.charAt(a.length-1)===p?e.push({what:"param",name:a.substr(1,a.length-2)}):e.push(a)},t.prototype._buildParseRegExp=function(){return this._paramsMap=[],this._parseRegExpSource="^"+this._buildParseRegExpParts(this._parts)+"$",this._parseRegExp=new RegExp(this._parseRegExpSource),this},t.prototype._buildParseRegExpParts=function(t){var e,r,n,a="";for(e=0,r=t.length;r>e;++e)n=t[e],"string"==typeof n?a+=o(n):n&&"param"===n.what?(this._paramsMap.push(n.name),a+="("+this._buildParamValueRegExpSource(n.name)+")"):n&&"optional"===n.what&&(a+="(?:"+this._buildParseRegExpParts(n.parts)+")?");return a},t.prototype._buildParamValueRegExpSource=function(t){var e,r=this._conditions[t];return e=r?i(r)?"(?:"+r.join("|")+")":r+"":c},t.prototype._buildBuildFn=function(){return this._buildFnSource="var h=({}).hasOwnProperty;return "+this._buildBuildFnParts(this._parts)+";",this._buildFn=new Function("p",this._buildFnSource),this},t.prototype._buildBuildFnParts=function(t){var e,r,a,i,s,u,p='""';for(e=0,r=t.length;r>e;++e)if(s=t[e],"string"==typeof s)p+='+"'+o(s)+'"';else if(s&&"param"===s.what)p+='+(h.call(p,"'+o(s.name)+'")?'+'p["'+o(s.name)+'"]:'+(this._defaults&&n.call(this._defaults,s.name)?'"'+o(this._defaults[s.name])+'"':'""')+")";else if(s&&"optional"===s.what){for(p+="+((false",a=0,i=s.dependOnParams.length;i>a;++a)u=s.dependOnParams[a],p+='||(h.call(p,"'+o(u)+'")'+(this._defaults&&n.call(this._defaults,u)?'&&p["'+o(u)+'"]!=="'+o(this._defaults[u])+'"':"")+")";p+=")?("+this._buildBuildFnParts(s.parts)+'):"")'}return p},t.prototype.match=function(t){var e,r,a,i,o,u=null,p=this._filterMatch;if("string"==typeof t)t={path:t};else if(!t)return u;for(i in t)if(n.call(t,i)&&"path"!==i&&this._data[i]!==t[i])return u;if("string"==typeof t.path){if(e=t.path.match(this._parseRegExp)){for(u={},r=1,a=e.length;a>r;++r)"undefined"!=typeof e[r]&&""!==e[r]&&(u[this._paramsMap[r-1]]=e[r]);for(i in this._defaults)n.call(this._defaults,i)&&!n.call(u,i)&&(u[i]=this._defaults[i]);o=s.parse(u.query_string);for(i in o)n.call(o,i)&&!n.call(u,i)&&(u[i]=o[i]);delete u.query_string}}else u={};return u&&p&&(u=p(u)),u},t.prototype.build=function(t){var e,r,a,i,o,u={},p={},l=this._filterBuild;l&&(t=l(t));for(r in t)if(n.call(t,r)&&null!==t[r]&&"undefined"!=typeof t[r]){for(a=!1,i=0,o=this._paramsMap.length;o>i;++i)if(this._paramsMap[i]===r){a=!0;break}a?u[r]=t[r]:p[r]=t[r]}return e=s.stringify(p),e&&(u.query_string=e),this._buildFn(u)},t.prototype.getData=function(){return this._data},t.prototype.getName=function(){return this._data.name},r.exports=t,r.exports},"./router":function(){function t(){return this instanceof t?(this._routes=[],this._routesByName={},void 0):new t}var r={},n=e("./route");return t.prototype.addRoute=function(t){var e,r;return e=new n(t),this._routes.push(e),r=e.getName(),r&&(this._routesByName[r]=e),e},t.prototype.find=function(t){var e,r,n,a=[],i=this._routes;for(r=0,n=i.length;n>r;++r)e=i[r].match(t),null!==e&&a.push([i[r],e]);return a},t.prototype.findFirst=function(t){var e,r,n,a=this._routes;for(r=0,n=a.length;n>r;++r)if(e=a[r].match(t),null!==e)return[a[r],e];return null},t.prototype.getRouteByName=function(t){return this._routesByName[t]||null},t.Route=n,r.exports=t,r.exports}}[t]()}t.Susanin=e("./router")}(this);